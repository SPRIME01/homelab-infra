#!/bin/bash
# Jetson Power Management Setup Script
# Generated by Ansible

# Set power mode using nvpmodel
nvpmodel -m {{ jetson_setup_power_mode }}

# Enable maximum clock frequencies
jetson_clocks

# Verify power mode
current_mode=$(nvpmodel -q | grep -oP 'Power Mode: \K\w+')
if [ "$current_mode" != "{{ jetson_setup_power_mode }}" ]; then
    echo "Failed to set power mode to {{ jetson_setup_power_mode }}"
    exit 1
fi

echo "Power management configured successfully"
exit 0